# Serve gaurosa.it static Next.js build from out/ subfolder
RewriteEngine On
RewriteBase /

# Bypass: API PHP files in root and api/ folder
RewriteRule ^api-.+\.php$ - [L]
RewriteRule ^api/.+$ - [L]
RewriteRule ^maintenance\.html$ - [L]
RewriteRule ^maintenance\.json$ - [L]

# Serve static assets from out/ (Next.js chunks, CSS, fonts, images)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}/out%{REQUEST_URI} -f
RewriteRule ^(.+)$ out/$1 [L]

# Serve static asset directories from out/
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}/out%{REQUEST_URI} -d
RewriteRule ^(.+)$ out/$1/ [L]

# If file exists in root (index.php, api-*.php), serve it directly
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Everything else goes to index.php (router)
RewriteRule ^ index.php [L]
