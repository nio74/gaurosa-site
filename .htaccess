# Reindirizza tutto a index.php (tranne file esistenti)
RewriteEngine On
RewriteBase /

# Bypass diretto per API manutenzione e file maintenance
RewriteRule ^api-maintenance\.php$ - [L]
RewriteRule ^maintenance\.html$ - [L]
RewriteRule ^maintenance\.json$ - [L]

# Reindirizza /_next/ verso out/_next/ (build statica Next.js)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^_next/(.*)$ out/_next/$1 [L]

# Reindirizza /images/ verso out/images/ (logo e immagini statiche)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^images/(.*)$ out/images/$1 [L]

# Reindirizza /uploads/ verso out/uploads/ (immagini prodotti)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^uploads/(.*)$ out/uploads/$1 [L]

# Se il file esiste fisicamente nella root, servilo
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Tutto il resto passa a index.php
RewriteRule ^ index.php [L]
