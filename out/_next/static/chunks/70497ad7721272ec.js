(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let t=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},88844,e=>{"use strict";let t=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],88844)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},50935,e=>{"use strict";var t=e.i(47167),s=e.i(43476),a=e.i(71645),r=e.i(57688),i=e.i(22016),l=e.i(46932),c=e.i(88653),n=e.i(75254);let o=(0,n.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),d=(0,n.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),x=(0,n.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var m=e.i(50965),h=e.i(72520),u=e.i(71689),p=e.i(15788);let y=(0,n.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var g=e.i(88844);let f=(0,n.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var j=e.i(37727),N=e.i(31278),v=e.i(5539),b=e.i(59544),w=e.i(75157);let k=t.default.env.NEXT_PUBLIC_API_BASE||"";function P(){let e,t,n,{cart:P,removeFromCart:S,updateQuantity:H,clearCart:C}=(0,v.useCart)(),[T,_]=(0,a.useState)(!1),[E,I]=(0,a.useState)(""),[M,R]=(0,a.useState)(null),[A,O]=(0,a.useState)(0),[q,z]=(0,a.useState)(null),[L,G]=(0,a.useState)(!1),[$,D]=(0,a.useState)(0),[F,U]=(0,a.useState)(null),[V,B]=(0,a.useState)(!1);(0,a.useCallback)(async()=>{if(!V&&0!==P.items.length)try{let e=P.items.map(e=>({code:e.product.code,price:e.variant?.price||e.product.price,quantity:e.quantity,category:e.product.macro_category||"",tags:e.product.tags||[]})),t=await fetch(`${k}/api/apply-promotion.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e,subtotal:P.subtotal})}),s=await t.json();s.success&&s.discount>0&&(D(s.discount),U(s.discount_label||"Promozione applicata")),B(!0)}catch{B(!0)}},[P.items,P.subtotal,V]);let K=async()=>{if(E.trim()){G(!0),z(null);try{let e=P.items.map(e=>({code:e.product.code,price:e.variant?.price||e.product.price,quantity:e.quantity,category:e.product.macro_category||"",tags:e.product.tags||[]})),t=await fetch(`${k}/api/apply-promotion.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e,subtotal:P.subtotal,coupon_code:E.trim().toUpperCase()})}),s=await t.json();if(!s.success)return void z("Errore nella verifica del coupon");if(!s.coupon_valid)return void z(s.coupon_error||"Codice coupon non valido");let a=s.applied_promotions?.find(e=>"coupon"===e.type);O(a?.discount||0),R(E.trim().toUpperCase()),I("")}catch{z("Errore di connessione. Riprova.")}finally{G(!1)}}},J=$+A,X=Math.max(0,P.subtotal-J),Q=X>=v.FREE_SHIPPING_THRESHOLD?0:v.SHIPPING_COST,W=X+Q;return 0===P.items.length?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,s.jsxs)(l.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md mx-auto text-center",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(m.ShoppingBag,{className:"w-12 h-12 text-gray-400"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Il tuo carrello Ã¨ vuoto"}),(0,s.jsx)("p",{className:"text-gray-500 mb-8",children:"Scopri i nostri gioielli e orologi per trovare qualcosa di speciale."}),(0,s.jsx)(i.default,{href:"/prodotti",children:(0,s.jsxs)(b.default,{size:"lg",children:[(0,s.jsx)(u.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Continua lo shopping"]})})]})})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Carrello"}),(0,s.jsx)("button",{onClick:()=>{window.confirm("Sei sicuro di voler svuotare il carrello?")&&(_(!0),setTimeout(()=>{C(),_(!1)},300))},className:"text-sm text-gray-500 hover:text-red-500 transition-colors",children:"Svuota carrello"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,s.jsx)(c.AnimatePresence,{mode:"popLayout",children:P.items.map(e=>{let t=`${e.product.code}-${e.variant?.sku||"default"}`,a=e.variant?.price||e.product.price,c=e.product.images[0]?.url||"/images/placeholder-product.jpg";return(0,s.jsxs)(l.motion.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(i.default,{href:`/prodotti/${e.product.code}`,className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-gray-100",children:(0,s.jsx)(r.default,{src:c,alt:e.product.name,fill:!0,className:"object-cover",sizes:"96px"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(i.default,{href:`/prodotti/${e.product.code}`,className:"block",children:(0,s.jsx)("h3",{className:"font-semibold text-gray-900 truncate hover:text-gray-600 transition-colors",children:e.product.name})}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.product.supplier||e.product.macro_category}),e.variant&&(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Taglia: ",e.variant.size]}),(0,s.jsx)("p",{className:"mt-1 font-semibold text-gray-900",children:(0,w.formatPrice)(a)})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end justify-between",children:[(0,s.jsx)("button",{onClick:()=>S(e.product.code,e.variant?.sku),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",title:"Rimuovi",children:(0,s.jsx)(o,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg",children:[(0,s.jsx)("button",{onClick:()=>H(e.product.code,e.quantity-1,e.variant?.sku),className:"p-2 hover:bg-gray-200 rounded-l-lg transition-colors",children:(0,s.jsx)(x,{className:"w-4 h-4"})}),(0,s.jsx)("span",{className:"w-8 text-center font-medium",children:e.quantity}),(0,s.jsx)("button",{onClick:()=>H(e.product.code,e.quantity+1,e.variant?.sku),className:"p-2 hover:bg-gray-200 rounded-r-lg transition-colors",children:(0,s.jsx)(d,{className:"w-4 h-4"})})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Subtotale (",e.quantity," ",1===e.quantity?"articolo":"articoli",")"]}),(0,s.jsx)("span",{className:"font-semibold",children:(0,w.formatPrice)(a*e.quantity)})]})]},t)})}),(0,s.jsx)("div",{className:"pt-4",children:(0,s.jsxs)(i.default,{href:"/prodotti",className:"inline-flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)(u.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Continua lo shopping"]})})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)(l.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 shadow-sm sticky top-24",children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Riepilogo ordine"}),(e=X>=v.FREE_SHIPPING_THRESHOLD,t=Math.min(X/v.FREE_SHIPPING_THRESHOLD*100,100),n=v.FREE_SHIPPING_THRESHOLD-X,(0,s.jsx)("div",{className:`mb-5 p-4 rounded-xl border-2 transition-all duration-500 ${e?"bg-green-50 border-green-200":"bg-rose-50/50 border-rose-100"}`,children:e?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(y,{className:"w-5 h-5 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-green-800 text-sm",children:"Complimenti! Spedizione GRATUITA"}),(0,s.jsxs)("p",{className:"text-xs text-green-600",children:["Risparmi ",(0,w.formatPrice)(v.SHIPPING_COST)," su questo ordine"]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(p.Truck,{className:"w-5 h-5 text-brand-rose"})}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"font-semibold text-gray-800 text-sm",children:["Ti mancano ",(0,s.jsx)("span",{className:"text-brand-rose",children:(0,w.formatPrice)(n)})," per la spedizione gratuita!"]})})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 overflow-hidden",children:(0,s.jsx)(l.motion.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #8b1538, #f9c3d5)"},initial:{width:0},animate:{width:`${t}%`},transition:{duration:.8,ease:"easeOut"}})}),(0,s.jsxs)("div",{className:"flex justify-between mt-1.5",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400",children:(0,w.formatPrice)(X)}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:(0,w.formatPrice)(v.FREE_SHIPPING_THRESHOLD)})]})]})})),(0,s.jsxs)("div",{className:"mb-4",children:[M?(0,s.jsxs)("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg px-3 py-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-700 text-sm",children:[(0,s.jsx)(f,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-mono font-bold",children:M}),(0,s.jsx)("span",{children:"applicato"})]}),(0,s.jsx)("button",{onClick:()=>{R(null),O(0),z(null)},className:"text-green-500 hover:text-red-500 transition-colors",children:(0,s.jsx)(j.X,{className:"w-4 h-4"})})]}):(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:E,onChange:e=>{I(e.target.value.toUpperCase()),z(null)},onKeyDown:e=>"Enter"===e.key&&K(),placeholder:"Codice coupon",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),(0,s.jsxs)("button",{onClick:K,disabled:L||!E.trim(),className:"px-3 py-2 bg-gray-800 text-white rounded-lg text-sm hover:bg-gray-700 disabled:opacity-50 flex items-center gap-1",children:[L?(0,s.jsx)(N.Loader2,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(f,{className:"w-4 h-4"}),"Applica"]})]}),q&&(0,s.jsx)("p",{className:"text-xs text-red-500 mt-1",children:q})]}),(0,s.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Subtotale"}),(0,s.jsx)("span",{className:"font-medium",children:(0,w.formatPrice)(P.subtotal)})]}),$>0&&(0,s.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(f,{className:"w-3.5 h-3.5"}),F||"Promozione"]}),(0,s.jsxs)("span",{className:"font-medium",children:["-",(0,w.formatPrice)($)]})]}),A>0&&(0,s.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(f,{className:"w-3.5 h-3.5"}),"Coupon ",M]}),(0,s.jsxs)("span",{className:"font-medium",children:["-",(0,w.formatPrice)(A)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Spedizione"}),0===Q?(0,s.jsxs)("span",{className:"font-medium text-green-600 flex items-center gap-1",children:[(0,s.jsx)(g.Package,{className:"w-3.5 h-3.5"}),"Gratuita"]}):(0,s.jsx)("span",{className:"font-medium",children:(0,w.formatPrice)(Q)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-400",children:[(0,s.jsx)("span",{children:"di cui IVA (22%)"}),(0,s.jsx)("span",{children:(0,w.formatPrice)(.22*W/1.22)})]})]}),(0,s.jsx)("div",{className:"my-4 border-t border-gray-200"}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"Totale"}),(0,s.jsxs)("div",{className:"text-right",children:[J>0&&(0,s.jsx)("p",{className:"text-sm text-gray-400 line-through",children:(0,w.formatPrice)(P.subtotal+(P.subtotal>=v.FREE_SHIPPING_THRESHOLD?0:v.SHIPPING_COST))}),(0,s.jsx)("span",{className:"text-xl font-bold text-gray-900",children:(0,w.formatPrice)(W)})]})]}),(0,s.jsx)(i.default,{href:`/checkout${M?`?coupon=${M}`:""}`,children:(0,s.jsxs)(b.default,{size:"lg",className:"w-full",children:["Procedi al checkout",(0,s.jsx)(h.ArrowRight,{className:"w-4 h-4 ml-2"})]})}),(0,s.jsxs)("div",{className:"mt-5 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,s.jsx)(p.Truck,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,s.jsxs)("span",{children:["Spedizione gratuita sopra ",(0,w.formatPrice)(v.FREE_SHIPPING_THRESHOLD)]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,s.jsx)(g.Package,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,s.jsx)("span",{children:"Spedizione assicurata e tracciata"})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-gray-400",children:"VISA"}),(0,s.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-gray-400",children:"MC"}),(0,s.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-blue-500",children:"PP"})]})]})})]})]})})}e.s(["default",()=>P],50935)}]);