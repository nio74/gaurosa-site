(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},90597,e=>{"use strict";let t=(0,e.i(75254).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);e.s(["Heart",()=>t],90597)},1928,e=>{"use strict";let t=(0,e.i(75254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);e.s(["ShoppingCart",()=>t],1928)},22133,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),i=e.i(46932),o=e.i(31278);let l=(0,e.i(75254).default)("sliders-horizontal",[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]]);var s=e.i(55436),n=e.i(37727),c=e.i(57688),d=e.i(22016),u=e.i(1928),m=e.i(90597),h=e.i(75157),x=e.i(5539),p=e.i(59544);function b({product:e,index:a=0}){let{addToCart:r}=(0,x.useCart)(),o=e.images.find(e=>e.is_primary)||e.images[0],l=o?.url_thumb||o?.url||"/images/placeholder-product.jpg",s=o?.blur_data_uri;return(0,t.jsx)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1*a},className:"group",children:(0,t.jsxs)(d.default,{href:`/prodotti/${e.code}`,children:[(0,t.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-xl bg-gray-100",children:[(0,t.jsx)(c.default,{src:l,alt:e.name,fill:!0,className:"object-cover transition-transform duration-500 group-hover:scale-110",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",placeholder:s?"blur":"empty",blurDataURL:s||void 0}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 transition-colors duration-300 group-hover:bg-black/10"}),!e.stock.available&&(0,t.jsx)("div",{className:"absolute top-3 left-3 bg-red-500 text-white text-xs font-medium px-2 py-1 rounded-full",children:"Esaurito"}),(0,t.jsxs)("div",{className:"absolute bottom-3 left-3 right-3 flex gap-2 opacity-0 translate-y-2 transition-all duration-300 group-hover:opacity-100 group-hover:translate-y-0",children:[(0,t.jsxs)(p.default,{onClick:t=>{t.preventDefault(),t.stopPropagation(),r(e)},disabled:!e.stock.available,className:"flex-1",size:"sm",children:[(0,t.jsx)(u.ShoppingCart,{className:"w-4 h-4 mr-2"}),"Aggiungi"]}),(0,t.jsx)(p.default,{variant:"secondary",size:"sm",className:"px-3",children:(0,t.jsx)(m.Heart,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"mt-4 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:e.supplier||e.macro_category}),(0,t.jsx)("h3",{className:"font-medium text-gray-900 line-clamp-2 group-hover:text-gray-600 transition-colors",children:e.name}),(0,t.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(0,h.formatPrice)(e.price)})]})]})})}var g=e.i(88653),f=e.i(64659);let v={giallo:"#FFD700",bianco:"#F5F5F5",rosa:"#FFB6C1",rosso:"#DC143C",verde:"#228B22",nero:"#1a1a1a",blu:"#1E3A8A",argento:"#C0C0C0",bicolore:"linear-gradient(135deg, #FFD700 50%, #F5F5F5 50%)",tricolore:"linear-gradient(135deg, #FFD700 33%, #F5F5F5 33%, #F5F5F5 66%, #FFB6C1 66%)",champagne:"#F7E7CE",rodio:"#E8E8E8",brunito:"#8B4513",satinato:"#D4D4D4",lucido:"#FFFACD",opaco:"#A9A9A9"},y={material:{oro_750:"Oro 750‰ (18K)",oro_585:"Oro 585‰ (14K)",oro_375:"Oro 375‰ (9K)",oro_999:"Oro 999‰ (24K)",oro_rosa:"Oro Rosa",oro_bianco:"Oro Bianco",argento_925:"Argento 925‰",argento_800:"Argento 800‰",argento_999:"Argento Puro",platino_950:"Platino 950‰",platino_900:"Platino 900‰",acciaio:"Acciaio",acciaio_inox:"Acciaio Inox",titanio:"Titanio",ceramica:"Ceramica",bronzo:"Bronzo",ottone:"Ottone",rame:"Rame",palladio:"Palladio",rodio:"Rodio",vermeil:"Vermeil",placcato_oro:"Placcato Oro",placcato_argento:"Placcato Argento",pelle:"Pelle",tessuto:"Tessuto",caucciu:"Caucciu",silicone:"Silicone",legno:"Legno",resina:"Resina",vetro:"Vetro di Murano",perla:"Perla"},material_color:{giallo:"Giallo",bianco:"Bianco",rosa:"Rosa",rosso:"Rosso",verde:"Verde",nero:"Nero",blu:"Blu",argento:"Argento",bicolore:"Bicolore",tricolore:"Tricolore",champagne:"Champagne",rodio:"Rodio",brunito:"Brunito",satinato:"Satinato",lucido:"Lucido",opaco:"Opaco"},stone_type:{diamante:"Diamante",rubino:"Rubino",zaffiro:"Zaffiro",smeraldo:"Smeraldo",ametista:"Ametista",topazio:"Topazio",acquamarina:"Acquamarina",tormalina:"Tormalina",granato:"Granato",opale:"Opale",tanzanite:"Tanzanite",peridoto:"Peridoto",citrino:"Citrino",morganite:"Morganite",kunzite:"Kunzite",spinello:"Spinello",alessandrite:"Alessandrite",tsavorite:"Tsavorite",zircone:"Zircone",cubic_zirconia:"Zirconia Cubica",perla:"Perla",perla_acqua_dolce:"Perla d'Acqua Dolce",perla_tahiti:"Perla di Tahiti",perla_south_sea:"Perla South Sea",corallo:"Corallo",turchese:"Turchese",lapislazzuli:"Lapislazzuli",onice:"Onice",agata:"Agata",giada:"Giada",quarzo_rosa:"Quarzo Rosa",madreperla:"Madreperla",cammeo:"Cammeo"},gender:{donna:"Donna",uomo:"Uomo",unisex:"Unisex",bambino:"Bambino/a",bambina:"Bambina"},sottocategoria:{anello:"Anelli",bracciale:"Bracciali",collana:"Collane",orecchini:"Orecchini",pendente:"Pendenti",ciondolo:"Ciondoli",gemelli:"Gemelli",spilla:"Spille",piercing:"Piercing",cavigliera:"Cavigliere",fermacravatta:"Fermacravatta"},item_condition:{nuovo:"Nuovo",come_nuovo:"Come Nuovo",ottimo:"Ottimo Stato",buono:"Buono Stato",discreto:"Discreto",usato:"Usato",ricondizionato:"Ricondizionato",vintage:"Vintage"}};function j(e,t){let a=y[e];return a&&a[t]?a[t]:t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function w(e){return new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}function N({title:e,children:r,defaultOpen:o=!0}){let[l,s]=(0,a.useState)(o);return(0,t.jsxs)("div",{className:"border-b border-gray-100 pb-4 mb-4 last:border-0 last:pb-0 last:mb-0",children:[(0,t.jsxs)("button",{onClick:()=>s(!l),className:"flex items-center justify-between w-full text-left py-1 group",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider",children:e}),(0,t.jsx)(f.ChevronDown,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${l?"rotate-180":""}`})]}),(0,t.jsx)(g.AnimatePresence,{initial:!1,children:l&&(0,t.jsx)(i.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"pt-3",children:r})})})]})}function k({filterCode:e,values:a,selected:r,onChange:i}){return 0===a.length?null:(0,t.jsx)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto pr-1 custom-scrollbar",children:a.map(a=>{let o=a.label||j(e,a.value),l=r.includes(a.value);return(0,t.jsxs)("div",{onClick:()=>{var e;return e=a.value,void(r.includes(e)?i(r.filter(t=>t!==e)):i([...r,e]))},className:"flex items-center gap-2.5 cursor-pointer group py-0.5",role:"checkbox","aria-checked":l,children:[(0,t.jsx)("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center transition-all flex-shrink-0 ${l?"bg-brand-rose border-brand-rose":"border-gray-300 group-hover:border-brand-pink-border"}`,children:l&&(0,t.jsx)("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("span",{className:`text-sm flex-1 select-none ${l?"text-gray-900 font-medium":"text-gray-600"}`,children:o}),(0,t.jsx)("span",{className:"text-xs text-gray-400 tabular-nums",children:a.count})]},a.value)})})}function C({values:e,selected:a,onChange:r}){return 0===e.length?null:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>{let i=v[e.value],o=a.includes(e.value),l=j("material_color",e.value);return(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.value,void(a.includes(t)?r(a.filter(e=>e!==t)):r([...a,t]))},title:`${l} (${e.count})`,className:`relative w-8 h-8 rounded-full transition-all ${o?"ring-2 ring-brand-rose ring-offset-2":"ring-1 ring-gray-200 hover:ring-brand-pink-border"}`,children:[(0,t.jsx)("span",{className:"absolute inset-0.5 rounded-full",style:{background:i||"#ccc",border:"bianco"===e.value?"1px solid #e5e7eb":void 0}}),o&&(0,t.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-3.5 h-3.5 text-brand-rose drop-shadow-[0_0_2px_rgba(255,255,255,0.8)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})]},e.value)})})}function _({values:e,selected:a,onChange:r}){return 0===e.length?null:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>{let i=a.includes(e.value);return(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.value,void(a.includes(t)?r(a.filter(e=>e!==t)):r([...a,t]))},className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium transition-all ${i?"ring-2 ring-brand-rose ring-offset-1":"hover:opacity-80"}`,style:{backgroundColor:e.color?`${e.color}20`:"#f3f4f6",color:e.color||"#374151",border:`1px solid ${e.color||"#d1d5db"}`},children:[e.icon&&(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.label||e.value}),(0,t.jsxs)("span",{className:"opacity-60",children:["(",e.count,")"]})]},e.value)})})}function z({min:e,max:r,currentMin:i,currentMax:o,onChange:l}){let s=10*Math.floor(e/10),n=10*Math.ceil(r/10),[c,d]=(0,a.useState)(i??s),[u,m]=(0,a.useState)(o??n),h=(0,a.useRef)(null);(0,a.useEffect)(()=>{d(i??s),m(o??n)},[i,o,s,n]);let x=(0,a.useCallback)((e,t)=>{d(e),m(t),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{l(e<=s?void 0:e,t>=n?void 0:t)},400)},[l,s,n]);if(n<=s)return null;let p=(c-s)/(n-s)*100,b=(u-s)/(n-s)*100;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:w(c)}),(0,t.jsx)("span",{className:"text-gray-400",children:"—"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:w(u)})]}),(0,t.jsxs)("div",{className:"relative h-6 flex items-center",children:[(0,t.jsx)("div",{className:"absolute w-full h-1 bg-gray-200 rounded-full"}),(0,t.jsx)("div",{className:"absolute h-1 bg-brand-rose rounded-full",style:{left:`${p}%`,width:`${b-p}%`}}),(0,t.jsx)("input",{type:"range",min:s,max:n,step:10,value:c,onChange:e=>{x(Math.min(Number(e.target.value),u-10),u)},className:"absolute w-full h-6 appearance-none bg-transparent pointer-events-none [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-brand-rose [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:pointer-events-auto [&::-webkit-slider-thumb]:shadow-sm [&::-webkit-slider-thumb]:hover:shadow-md [&::-webkit-slider-thumb]:transition-shadow [&::-moz-range-thumb]:w-5 [&::-moz-range-thumb]:h-5 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-brand-rose [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:pointer-events-auto ",style:{zIndex:c>n-100?5:3}}),(0,t.jsx)("input",{type:"range",min:s,max:n,step:10,value:u,onChange:e=>{let t=Math.max(Number(e.target.value),c+10);x(c,t)},className:"absolute w-full h-6 appearance-none bg-transparent pointer-events-none [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-brand-rose [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:pointer-events-auto [&::-webkit-slider-thumb]:shadow-sm [&::-webkit-slider-thumb]:hover:shadow-md [&::-webkit-slider-thumb]:transition-shadow [&::-moz-range-thumb]:w-5 [&::-moz-range-thumb]:h-5 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-brand-rose [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:pointer-events-auto ",style:{zIndex:4}})]})]})}function F({filters:e,priceRange:r,activeFilters:i,onFilterChange:o,totalFiltered:s,className:n=""}){let c=Object.entries(i).reduce((e,[t,a])=>Array.isArray(a)?e+a.length:null!=a?e+1:e,0),d=(0,a.useCallback)((e,t)=>{o({...i,[e]:t.length>0?t:void 0})},[i,o]),u=(0,a.useCallback)((e,t)=>{o({...i,price_min:e,price_max:t})},[i,o]),m=(0,a.useCallback)(()=>{o({})},[o]);return(0,t.jsxs)("div",{className:n,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l,{className:"w-4 h-4 text-brand-rose"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Filtri"}),c>0&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-brand-rose text-white text-xs rounded-full",children:c})]}),c>0&&(0,t.jsx)("button",{onClick:m,className:"text-xs text-brand-rose hover:text-brand-rose-dark font-medium transition-colors",children:"Rimuovi tutto"})]}),e.map(e=>{if(0===e.values.length)return null;let a=i[e.code];return(0,t.jsx)(N,{title:e.label,defaultOpen:e.values.length<=8,children:"color"===e.type?(0,t.jsx)(C,{values:e.values,selected:a||[],onChange:t=>d(e.code,t)}):"tag"===e.type?(0,t.jsx)(_,{values:e.values,selected:a||[],onChange:t=>d(e.code,t)}):(0,t.jsx)(k,{filterCode:e.code,values:e.values,selected:a||[],onChange:t=>d(e.code,t)})},e.code)}),r.max>r.min&&(0,t.jsx)(N,{title:"Prezzo",defaultOpen:!0,children:(0,t.jsx)(z,{min:r.min,max:r.max,currentMin:i.price_min,currentMax:i.price_max,onChange:u})}),(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,t.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:s})," ","prodott",1===s?"o":"i"," trovati"]})})]})}function S({isOpen:e,onClose:r,filters:s,priceRange:c,activeFilters:d,onFilterChange:u,totalFiltered:m,loading:h=!1}){return(0,a.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),(0,t.jsx)(g.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40"}),(0,t.jsxs)(i.motion.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:28,stiffness:250},className:"fixed inset-y-0 right-0 w-full max-w-md bg-white z-50 flex flex-col shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-5 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l,{className:"w-5 h-5 text-brand-rose"}),(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"Filtri"})]}),(0,t.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,t.jsx)(n.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:h&&0===s.length?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(o.Loader2,{className:"w-6 h-6 animate-spin text-brand-rose/50"})}):(0,t.jsx)(F,{filters:s,priceRange:c,activeFilters:d,onFilterChange:u,totalFiltered:m})}),(0,t.jsx)("div",{className:"px-6 py-4 border-t bg-white",children:(0,t.jsxs)("button",{onClick:r,className:"w-full py-3.5 bg-brand-rose text-white font-medium rounded-full hover:bg-brand-rose-dark transition-colors text-sm",children:["Mostra ",m," prodott",1===m?"o":"i"]})})]})]})})}var A=e.i(9165);let P={anello:"Anelli",bracciale:"Bracciali",collana:"Collane",orecchini:"Orecchini",pendente:"Pendenti",ciondolo:"Ciondoli",gemelli:"Gemelli",spilla:"Spille"};function R(){let e=(0,r.useRouter)(),c=(0,r.useSearchParams)(),[d,u]=(0,a.useState)([]),[m,h]=(0,a.useState)(!0),[x,g]=(0,a.useState)(!0),[f,v]=(0,a.useState)(0),[y,j]=(0,a.useState)(1),[w,N]=(0,a.useState)(1),[k,C]=(0,a.useState)(c.get("sort")||"newest"),[_,z]=(0,a.useState)(!1),[F,R]=(0,a.useState)({}),[$,O]=(0,a.useState)([]),[T,B]=(0,a.useState)({min:0,max:1e4,avg:500}),D=c.get("sottocategoria")||"",L=c.get("categoria")||"",E=c.get("collezione")||"",q=c.get("search")||"",U=c.toString(),K=(0,a.useRef)(U),[H,G]=(0,a.useState)(0);(0,a.useEffect)(()=>{U!==K.current&&(K.current=U,R({}),j(1),C(c.get("sort")||"newest"),G(e=>e+1))},[U]);let I=(0,a.useRef)(F);I.current=F;let V=(0,a.useRef)(y);V.current=y;let X=(0,a.useRef)(k);X.current=k,(0,a.useEffect)(()=>{let e=!1;return async function(){let t=I.current,a=V.current,r=X.current;h(!0);try{let i=await (0,A.fetchProducts)({categoria:L||void 0,sottocategoria:D||void 0,collezione:E||void 0,search:q||void 0,page:a,limit:12,sort:r,material:t.material?.join(",")||void 0,material_color:t.material_color?.join(",")||void 0,stone_type:t.stone_type?.join(",")||void 0,gender:t.gender?.join(",")||void 0,price_min:t.price_min,price_max:t.price_max,tag:t.tag?.join(",")||void 0});if(!e&&i.success){let e=i.data.products.map(e=>(0,A.transformProduct)(e));u(e),v(i.data.pagination.total),N(i.data.pagination.pages)}}catch(e){console.error("Errore caricamento prodotti:",e)}finally{e||h(!1)}}(),()=>{e=!0}},[H,D,L,E,q]),(0,a.useEffect)(()=>{let e=!1,t=setTimeout(async function(){try{g(!0);let t={...I.current};D&&(t.sottocategoria=[D]);let a=await (0,A.fetchFilters)(t);!e&&a.success&&a.data&&(O(a.data.filters||[]),B(a.data.price_range||{min:0,max:1e4,avg:500}))}catch(e){console.error("Error loading filters:",e)}finally{e||g(!1)}},100);return()=>{e=!0,clearTimeout(t)}},[H,D]);let Z=(0,a.useCallback)(e=>{let{sottocategoria:t,...a}=e;R(a),j(1),G(e=>e+1)},[]);(0,a.useCallback)(e=>{C(e),j(1),G(e=>e+1)},[]);let W=(0,a.useCallback)(()=>{R({}),j(1),G(e=>e+1)},[]),Q=(0,a.useCallback)(e=>{j(e),G(e=>e+1),window.scrollTo({top:0,behavior:"smooth"})},[]),J=(0,a.useCallback)((e,t)=>{if("price"===e)return void Z({...F,price_min:void 0,price_max:void 0});let a=F[e];if(a){let r=a.filter(e=>e!==t);Z({...F,[e]:r.length>0?r:void 0})}},[F,Z]),Y=Object.entries(F).reduce((e,[,t])=>Array.isArray(t)?e+t.length:null!=t?e+1:e,0),ee=q?`Risultati per "${q}"`:E?`Collezione ${E.charAt(0).toUpperCase()+E.slice(1)}`:D?P[D]||D:"Tutti i Prodotti",et=(0,a.useCallback)(()=>{let t=new URLSearchParams(c.toString());t.delete("search");let a=t.toString();e.push(`/prodotti${a?"?"+a:""}`,{scroll:!1})},[c,e]);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,t.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:ee}),(0,t.jsxs)("p",{className:"mt-2 text-gray-500",children:[f," prodott",1===f?"o":"i"," disponibil",1===f?"e":"i"]})]})})}),(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:[(0,t.jsxs)("button",{onClick:()=>z(!0),className:`inline-flex items-center gap-2 px-4 py-2.5 rounded-full border transition-all text-sm font-medium ${Y>0?"bg-brand-rose text-white border-brand-rose hover:bg-brand-rose-dark":"bg-white text-gray-700 border-gray-200 hover:border-brand-pink-border hover:bg-brand-pink-light"}`,children:[(0,t.jsx)(l,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Filtri"}),Y>0&&(0,t.jsx)("span",{className:"w-5 h-5 bg-white/20 text-white text-xs font-bold rounded-full flex items-center justify-center",children:Y})]}),q&&(0,t.jsxs)("button",{onClick:et,className:"inline-flex items-center gap-1.5 px-3 py-2 bg-white text-gray-700 text-sm rounded-full border border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(s.Search,{className:"w-3.5 h-3.5 text-gray-400"}),(0,t.jsxs)("span",{children:["“",q,"”"]}),(0,t.jsx)(n.X,{className:"w-3.5 h-3.5 text-gray-400 hover:text-gray-600"})]}),(0,t.jsx)(M,{activeFilters:F,onRemove:J,onClearAll:W})]}),m?(0,t.jsx)("div",{className:"flex items-center justify-center py-24",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)(o.Loader2,{className:"w-8 h-8 animate-spin text-brand-rose/50"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Caricamento prodotti..."})]})}):d.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 lg:gap-6",children:d.map((e,a)=>(0,t.jsx)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a,duration:.3},children:(0,t.jsx)(b,{product:e,index:a})},e.code))}),w>1&&(0,t.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-12",children:[(0,t.jsx)(p.default,{variant:"outline",size:"sm",onClick:()=>Q(Math.max(1,y-1)),disabled:1===y,children:"Precedente"}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(w,5)},(e,a)=>{let r;return r=w<=5||y<=3?a+1:y>=w-2?w-4+a:y-2+a,(0,t.jsx)("button",{onClick:()=>Q(r),className:`w-9 h-9 rounded-full text-sm font-medium transition-colors ${y===r?"bg-brand-rose text-white":"text-gray-600 hover:bg-brand-pink-light"}`,children:r},r)})}),(0,t.jsx)(p.default,{variant:"outline",size:"sm",onClick:()=>Q(Math.min(w,y+1)),disabled:y===w,children:"Successiva"})]})]}):(0,t.jsxs)("div",{className:"text-center py-24",children:[(0,t.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 bg-brand-pink-light rounded-full flex items-center justify-center",children:(0,t.jsx)(s.Search,{className:"w-8 h-8 text-brand-rose/50"})}),(0,t.jsx)("p",{className:"text-gray-700 text-lg font-medium mb-2",children:"Nessun prodotto trovato"}),(0,t.jsx)("p",{className:"text-gray-400 text-sm mb-6",children:"Prova a modificare i filtri o la ricerca"}),Y>0&&(0,t.jsx)(p.default,{variant:"outline",onClick:W,children:"Rimuovi tutti i filtri"})]})]}),(0,t.jsx)(S,{isOpen:_,onClose:()=>z(!1),filters:$,priceRange:T,activeFilters:F,onFilterChange:Z,totalFiltered:f,loading:x})]})}function M({activeFilters:e,onRemove:a,onClearAll:r}){let o=[];for(let t of["material","material_color","gender","stone_type","tag"]){let a=e[t];if(a?.length)for(let e of a)o.push({filterCode:t,value:e,label:j(t,e)})}if(void 0!==e.price_min||void 0!==e.price_max){let t=e.price_min?w(e.price_min):"",a=e.price_max?w(e.price_max):"";o.push({filterCode:"price",value:"range",label:`${t} — ${a}`.trim()})}return 0===o.length?null:(0,t.jsxs)(t.Fragment,{children:[o.map((e,r)=>(0,t.jsxs)(i.motion.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:()=>a(e.filterCode,e.value),className:"inline-flex items-center gap-1.5 px-3 py-2 bg-brand-pink-light text-brand-text text-sm rounded-full border border-brand-pink-border/30 hover:bg-brand-pink transition-colors",children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)(n.X,{className:"w-3.5 h-3.5 text-brand-rose/60"})]},`${e.filterCode}-${e.value}-${r}`)),o.length>1&&(0,t.jsx)("button",{onClick:r,className:"text-sm text-brand-rose hover:text-brand-rose-dark font-medium px-2 py-2 transition-colors",children:"Rimuovi tutti"})]})}function $(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)(o.Loader2,{className:"w-8 h-8 animate-spin text-brand-rose/50"})}),children:(0,t.jsx)(R,{})})}e.s(["default",()=>$],22133)}]);