(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88844,e=>{"use strict";let a=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>a],88844)},63488,e=>{"use strict";let a=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>a],63488)},31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},69638,e=>{"use strict";let a=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>a],69638)},73884,e=>{"use strict";let a=(0,e.i(75254).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>a],73884)},87608,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(18566),r=e.i(22016),i=e.i(46932),l=e.i(69638),n=e.i(73884),c=e.i(31278),d=e.i(88844),o=e.i(63488),m=e.i(72520),x=e.i(50965);let u=(0,e.i(75254).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var h=e.i(59544),p=e.i(5539),f=e.i(75157);function g(){let e=(0,s.useSearchParams)(),{clearCart:g}=(0,p.useCart)(),[j,y]=(0,t.useState)("loading"),[N,b]=(0,t.useState)(null),[v,w]=(0,t.useState)("");return(0,t.useEffect)(()=>{!async function(){let a=e.get("payment_intent"),t=e.get("redirect_status"),s=e.get("order_id");if(e.get("payment_intent_client_secret"),!a&&!s){y("error"),w("Parametri ordine mancanti. Controlla la tua email per la conferma.");return}if("failed"===t){y("error"),w("Il pagamento non è andato a buon fine. Nessun addebito è stato effettuato.");return}try{let e=await fetch("/api/checkout/confirm-order.php",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({paymentIntentId:a,orderId:s?parseInt(s):void 0})}),r=await e.json();r.success?(b({orderId:r.order?.id||r.orderId,orderNumber:r.order?.orderNumber||r.orderNumber||"N/A",total:r.order?.total||0,email:r.order?.customerEmail||"",status:r.order?.status||"processing",paymentStatus:r.order?.paymentStatus||"paid"}),y("success"),g()):"succeeded"===t||"processing"===t?(b({orderId:0,orderNumber:"",total:0,email:"",status:"processing",paymentStatus:"processing"}),y("success"),g()):(y("error"),w(r.error||"Errore nella conferma dell'ordine"))}catch{"succeeded"===t?(b({orderId:0,orderNumber:"",total:0,email:"",status:"processing",paymentStatus:"paid"}),y("success"),g()):(y("error"),w("Errore di connessione. Se hai completato il pagamento, riceverai una email di conferma."))}}()},[]),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:["loading"===j&&(0,a.jsxs)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Loader2,{className:"w-10 h-10 text-brand-rose animate-spin"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Conferma in corso..."}),(0,a.jsx)("p",{className:"text-gray-500",children:"Stiamo verificando il tuo pagamento"})]}),"success"===j&&(0,a.jsxs)(i.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-12 text-center mb-6",children:[(0,a.jsx)(i.motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-24 h-24 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(l.CheckCircle,{className:"w-14 h-14 text-green-500"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Ordine confermato!"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 mb-2",children:"Grazie per il tuo acquisto"}),N?.orderNumber&&"N/A"!==N.orderNumber&&(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gray-50 rounded-full px-6 py-3 mt-4",children:[(0,a.jsx)(d.Package,{className:"w-5 h-5 text-brand-rose"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Ordine n."}),(0,a.jsx)("span",{className:"font-bold text-brand-rose text-lg",children:N.orderNumber})]}),N?.total?(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-6",children:(0,f.formatPrice)(N.total)}):null]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(o.Mail,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Email di conferma"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:N?.email?(0,a.jsxs)(a.Fragment,{children:["Riceverai una conferma a ",(0,a.jsx)("strong",{children:N.email})]}):"Riceverai una email di conferma con i dettagli del tuo ordine."})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(d.Package,{className:"w-5 h-5 text-amber-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Spedizione"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Il tuo ordine sarà preparato e spedito entro 1-2 giorni lavorativi. Riceverai il codice di tracciamento via email."})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)(r.default,{href:"/prodotti",className:"flex-1",children:(0,a.jsxs)(h.default,{variant:"outline",size:"lg",className:"w-full",children:[(0,a.jsx)(x.ShoppingBag,{className:"w-4 h-4 mr-2"}),"Continua lo shopping"]})}),(0,a.jsx)(r.default,{href:"/",className:"flex-1",children:(0,a.jsxs)(h.default,{size:"lg",className:"w-full",children:[(0,a.jsx)(u,{className:"w-4 h-4 mr-2"}),"Torna alla home"]})})]})]}),"error"===j&&(0,a.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.XCircle,{className:"w-10 h-10 text-red-500"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Qualcosa non ha funzionato"}),(0,a.jsx)("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:v}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,a.jsx)(r.default,{href:"/carrello",children:(0,a.jsxs)(h.default,{variant:"outline",size:"lg",children:[(0,a.jsx)(m.ArrowRight,{className:"w-4 h-4 mr-2 rotate-180"}),"Torna al carrello"]})}),(0,a.jsx)(r.default,{href:"/contatti",children:(0,a.jsx)(h.default,{size:"lg",children:"Contattaci per assistenza"})})]})]})]})})}function j(){return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[(0,a.jsx)(c.Loader2,{className:"w-10 h-10 text-brand-rose animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Caricamento..."})]})})}function y(){return(0,a.jsx)(t.Suspense,{fallback:(0,a.jsx)(j,{}),children:(0,a.jsx)(g,{})})}e.s(["default",()=>y],87608)}]);