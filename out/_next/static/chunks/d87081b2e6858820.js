(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15788,e=>{"use strict";let s=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>s],15788)},31278,e=>{"use strict";let s=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],31278)},88844,e=>{"use strict";let s=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>s],88844)},71689,e=>{"use strict";let s=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],71689)},50935,e=>{"use strict";var s=e.i(47167),t=e.i(43476),a=e.i(71645),r=e.i(57688),l=e.i(22016),i=e.i(46932),n=e.i(88653),c=e.i(75254);let o=(0,c.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),d=(0,c.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),x=(0,c.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var m=e.i(50965),u=e.i(72520),h=e.i(71689),p=e.i(15788);let g=(0,c.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var f=e.i(88844);let j=(0,c.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var y=e.i(37727),N=e.i(31278),b=e.i(5539),v=e.i(59544),w=e.i(75157);let k=s.default.env.NEXT_PUBLIC_API_BASE||"";function P(){let e,s,c,{cart:P,removeFromCart:S,updateQuantity:H,clearCart:C}=(0,b.useCart)(),[T,_]=(0,a.useState)(!1),[E,I]=(0,a.useState)(""),[M,R]=(0,a.useState)(null),[A,O]=(0,a.useState)(0),[q,z]=(0,a.useState)(null),[L,$]=(0,a.useState)(!1),[F,G]=(0,a.useState)(0),[D,U]=(0,a.useState)(null),[V,B]=(0,a.useState)(!1),[K,J]=(0,a.useState)(null),X=(0,a.useCallback)(()=>P.items.map(e=>({code:e.product.code,name:e.product.name,price:e.variant?.price||e.product.price,quantity:e.quantity,category:e.product.macro_category||"",tags:e.product.tags||[]})),[P.items]),Q=(0,a.useCallback)(async()=>{if(0===P.items.length){G(0),U(null),J(null),B(!0);return}try{let e=await fetch(`${k}/api/apply-promotion.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:X(),subtotal:P.subtotal})}),s=await e.json();s.success&&(G(s.discount>0?s.discount:0),U(s.discount_label||null),J(s.bundle_info||null)),B(!0)}catch{B(!0)}},[P.items,P.subtotal,X]),W=async()=>{if(E.trim()){$(!0),z(null);try{let e=await fetch(`${k}/api/apply-promotion.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:X(),subtotal:P.subtotal,coupon_code:E.trim().toUpperCase()})}),s=await e.json();if(!s.success)return void z("Errore nella verifica del coupon");if(!s.coupon_valid)return void z(s.coupon_error||"Codice coupon non valido");let t=s.applied_promotions?.find(e=>"coupon"===e.type);O(t?.discount||0),R(E.trim().toUpperCase()),I("")}catch{z("Errore di connessione. Riprova.")}finally{$(!1)}}};(0,a.useEffect)(()=>{B(!1),Q()},[P.items.length,P.subtotal]);let Y=F+A,Z=Math.max(0,P.subtotal-Y),ee=Z>=b.FREE_SHIPPING_THRESHOLD?0:b.SHIPPING_COST,es=Z+ee;return 0===P.items.length?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md mx-auto text-center",children:[(0,t.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(m.ShoppingBag,{className:"w-12 h-12 text-gray-400"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Il tuo carrello Ã¨ vuoto"}),(0,t.jsx)("p",{className:"text-gray-500 mb-8",children:"Scopri i nostri gioielli e orologi per trovare qualcosa di speciale."}),(0,t.jsx)(l.default,{href:"/prodotti",children:(0,t.jsxs)(v.default,{size:"lg",children:[(0,t.jsx)(h.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Continua lo shopping"]})})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Carrello"}),(0,t.jsx)("button",{onClick:()=>{window.confirm("Sei sicuro di voler svuotare il carrello?")&&(_(!0),setTimeout(()=>{C(),_(!1)},300))},className:"text-sm text-gray-500 hover:text-red-500 transition-colors",children:"Svuota carrello"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)(n.AnimatePresence,{mode:"popLayout",children:P.items.map(e=>{let s=`${e.product.code}-${e.variant?.sku||"default"}`,a=e.variant?.price||e.product.price,n=e.product.images[0]?.url||"/images/placeholder-product.jpg";return(0,t.jsxs)(i.motion.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(l.default,{href:`/prodotti/${e.product.code}`,className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-gray-100",children:(0,t.jsx)(r.default,{src:n,alt:e.product.name,fill:!0,className:"object-cover",sizes:"96px"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(l.default,{href:`/prodotti/${e.product.code}`,className:"block",children:(0,t.jsx)("h3",{className:"font-semibold text-gray-900 truncate hover:text-gray-600 transition-colors",children:e.product.name})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.product.supplier||e.product.macro_category}),e.variant&&(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Taglia: ",e.variant.size]}),(0,t.jsx)("p",{className:"mt-1 font-semibold text-gray-900",children:(0,w.formatPrice)(a)})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end justify-between",children:[(0,t.jsx)("button",{onClick:()=>S(e.product.code,e.variant?.sku),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",title:"Rimuovi",children:(0,t.jsx)(o,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg",children:[(0,t.jsx)("button",{onClick:()=>H(e.product.code,e.quantity-1,e.variant?.sku),className:"p-2 hover:bg-gray-200 rounded-l-lg transition-colors",children:(0,t.jsx)(x,{className:"w-4 h-4"})}),(0,t.jsx)("span",{className:"w-8 text-center font-medium",children:e.quantity}),(0,t.jsx)("button",{onClick:()=>H(e.product.code,e.quantity+1,e.variant?.sku),className:"p-2 hover:bg-gray-200 rounded-r-lg transition-colors",children:(0,t.jsx)(d,{className:"w-4 h-4"})})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["Subtotale (",e.quantity," ",1===e.quantity?"articolo":"articoli",")"]}),(0,t.jsx)("span",{className:"font-semibold",children:(0,w.formatPrice)(a*e.quantity)})]})]},s)})}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsxs)(l.default,{href:"/prodotti",className:"inline-flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,t.jsx)(h.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Continua lo shopping"]})})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 shadow-sm sticky top-24",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Riepilogo ordine"}),K&&(()=>{let{items_in_cart:e,items_needed:s,free_percent:a,cheapest_name:r,cheapest_price:l,discount_applied:n,potential_discount:c}=K,o=e>=3&&n>0,d=a>=99;return(0,t.jsx)(i.motion.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},className:`mb-4 p-4 rounded-xl border-2 transition-all duration-500 ${o?"bg-purple-50 border-purple-200":"bg-amber-50/60 border-amber-200"}`,children:o?(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(g,{className:"w-5 h-5 text-purple-600"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-semibold text-purple-800 text-sm",children:"ðŸŽ‰ Promozione Bundle attiva!"}),r&&(0,t.jsxs)("p",{className:"text-xs text-purple-600 mt-0.5 truncate",children:["Â«",r,"Â» scontato del"," ",(0,t.jsxs)("strong",{children:[d?"100":Math.round(a),"%"]}),null!=l&&(0,t.jsxs)(t.Fragment,{children:[" â†’ risparmi ",(0,t.jsx)("strong",{children:(0,w.formatPrice)(n)})]})]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(g,{className:"w-5 h-5 text-amber-600"})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("p",{className:"font-semibold text-gray-800 text-sm leading-snug",children:2===s?(0,t.jsxs)(t.Fragment,{children:["Aggiungi ",(0,t.jsx)("span",{className:"text-amber-600 font-bold",children:"2 prodotti"})," e il meno caro sarÃ "," ",d?"quasi gratis":`scontato del ${Math.round(a)}%`,"!"]}):(0,t.jsxs)(t.Fragment,{children:["Aggiungi ancora ",(0,t.jsx)("span",{className:"text-amber-600 font-bold",children:"1 prodotto"})," e il meno caro sarÃ "," ",d?"quasi gratis":`scontato del ${Math.round(a)}%`,"!",c>0&&(0,t.jsxs)(t.Fragment,{children:[" Risparmieresti ",(0,t.jsx)("strong",{className:"text-amber-700",children:(0,w.formatPrice)(c)}),"!"]})]})})})]}),(0,t.jsx)("div",{className:"flex gap-1.5 mb-2",children:[0,1,2].map(s=>(0,t.jsx)("div",{className:`flex-1 h-2.5 rounded-full transition-all duration-500 ${s<e?"bg-amber-400":"bg-gray-200"}`},s))}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-400",children:[(0,t.jsxs)("span",{children:[e," ",1===e?"prodotto":"prodotti"," nel carrello"]}),(0,t.jsx)("span",{children:"3 per il bundle"})]})]})})})(),(e=Z>=b.FREE_SHIPPING_THRESHOLD,s=Math.min(Z/b.FREE_SHIPPING_THRESHOLD*100,100),c=b.FREE_SHIPPING_THRESHOLD-Z,(0,t.jsx)("div",{className:`mb-5 p-4 rounded-xl border-2 transition-all duration-500 ${e?"bg-green-50 border-green-200":"bg-rose-50/50 border-rose-100"}`,children:e?(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(g,{className:"w-5 h-5 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-green-800 text-sm",children:"Complimenti! Spedizione GRATUITA"}),(0,t.jsxs)("p",{className:"text-xs text-green-600",children:["Risparmi ",(0,w.formatPrice)(b.SHIPPING_COST)," su questo ordine"]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(p.Truck,{className:"w-5 h-5 text-brand-rose"})}),(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"font-semibold text-gray-800 text-sm",children:["Ti mancano ",(0,t.jsx)("span",{className:"text-brand-rose",children:(0,w.formatPrice)(c)})," per la spedizione gratuita!"]})})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 overflow-hidden",children:(0,t.jsx)(i.motion.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #8b1538, #f9c3d5)"},initial:{width:0},animate:{width:`${s}%`},transition:{duration:.8,ease:"easeOut"}})}),(0,t.jsxs)("div",{className:"flex justify-between mt-1.5",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(0,w.formatPrice)(Z)}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(0,w.formatPrice)(b.FREE_SHIPPING_THRESHOLD)})]})]})})),(0,t.jsxs)("div",{className:"mb-4",children:[M?(0,t.jsxs)("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-700 text-sm",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"font-mono font-bold",children:M}),(0,t.jsx)("span",{children:"applicato"})]}),(0,t.jsx)("button",{onClick:()=>{R(null),O(0),z(null)},className:"text-green-500 hover:text-red-500 transition-colors",children:(0,t.jsx)(y.X,{className:"w-4 h-4"})})]}):(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:E,onChange:e=>{I(e.target.value.toUpperCase()),z(null)},onKeyDown:e=>"Enter"===e.key&&W(),placeholder:"Codice coupon",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),(0,t.jsxs)("button",{onClick:W,disabled:L||!E.trim(),className:"px-3 py-2 bg-gray-800 text-white rounded-lg text-sm hover:bg-gray-700 disabled:opacity-50 flex items-center gap-1",children:[L?(0,t.jsx)(N.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(j,{className:"w-4 h-4"}),"Applica"]})]}),q&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:q})]}),(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Subtotale"}),(0,t.jsx)("span",{className:"font-medium",children:(0,w.formatPrice)(P.subtotal)})]}),F>0&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(j,{className:"w-3.5 h-3.5"}),D||"Promozione"]}),(0,t.jsxs)("span",{className:"font-medium",children:["-",(0,w.formatPrice)(F)]})]}),A>0&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(j,{className:"w-3.5 h-3.5"}),"Coupon ",M]}),(0,t.jsxs)("span",{className:"font-medium",children:["-",(0,w.formatPrice)(A)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Spedizione"}),0===ee?(0,t.jsxs)("span",{className:"font-medium text-green-600 flex items-center gap-1",children:[(0,t.jsx)(f.Package,{className:"w-3.5 h-3.5"}),"Gratuita"]}):(0,t.jsx)("span",{className:"font-medium",children:(0,w.formatPrice)(ee)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-400",children:[(0,t.jsx)("span",{children:"di cui IVA (22%)"}),(0,t.jsx)("span",{children:(0,w.formatPrice)(.22*es/1.22)})]})]}),(0,t.jsx)("div",{className:"my-4 border-t border-gray-200"}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"Totale"}),(0,t.jsxs)("div",{className:"text-right",children:[Y>0&&(0,t.jsx)("p",{className:"text-sm text-gray-400 line-through",children:(0,w.formatPrice)(P.subtotal+(P.subtotal>=b.FREE_SHIPPING_THRESHOLD?0:b.SHIPPING_COST))}),(0,t.jsx)("span",{className:"text-xl font-bold text-gray-900",children:(0,w.formatPrice)(es)})]})]}),(0,t.jsx)(l.default,{href:`/checkout${M?`?coupon=${M}`:""}`,children:(0,t.jsxs)(v.default,{size:"lg",className:"w-full",children:["Procedi al checkout",(0,t.jsx)(u.ArrowRight,{className:"w-4 h-4 ml-2"})]})}),(0,t.jsxs)("div",{className:"mt-5 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)(p.Truck,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,t.jsxs)("span",{children:["Spedizione gratuita sopra ",(0,w.formatPrice)(b.FREE_SHIPPING_THRESHOLD)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)(f.Package,{className:"w-3.5 h-3.5 flex-shrink-0"}),(0,t.jsx)("span",{children:"Spedizione assicurata e tracciata"})]})]}),(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-gray-400",children:"VISA"}),(0,t.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-gray-400",children:"MC"}),(0,t.jsx)("div",{className:"w-10 h-6 bg-gray-100 rounded flex items-center justify-center text-xs font-bold text-blue-500",children:"PP"})]})]})})]})]})})}e.s(["default",()=>P],50935)}]);