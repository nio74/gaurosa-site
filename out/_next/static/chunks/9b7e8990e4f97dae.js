(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32189,(e,t,r)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},65156,(e,t,r)=>{"use strict";var a=e.r(32189);function s(){}function n(){}n.resetWarningCache=s,t.exports=function(){function e(e,t,r,s,n,i){if(i!==a){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:s};return r.PropTypes=r,r}},45009,(e,t,r)=>{t.exports=e.r(65156)()},69439,e=>{"use strict";e.i(47167);var t,r=e.i(43476),a=e.i(71645),s=e.i(18566),n=e.i(46932),i=e.i(88653),o=e.i(84614),l=e.i(46897),c=e.i(78583),d=e.i(61659),m=e.i(50965),u=e.i(15788);let p=(0,e.i(75254).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var h=e.i(69638),f=e.i(63209),g=e.i(31278);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y="clover",b="https://js.stripe.com",v="".concat(b,"/").concat(y,"/stripe.js"),j=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,N=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,C=function(){for(var e=document.querySelectorAll('script[src^="'.concat(b,'"]')),t=0;t<e.length;t++){var r,a=e[t];if(r=a.src,j.test(r)||N.test(r))return a}return null},w=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(v).concat(t);var a=document.head||document.body;if(!a)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(r),r},S=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"8.7.0",startTime:t})},k=null,P=null,E=null,A=function(e,t,r){if(null===e)return null;var a,s=t[0];if("string"!=typeof s)throw Error("Expected publishable key to be of type string, got type ".concat(x(s)," instead."));var n=s.match(/^pk_test/),i=3===(a=e.version)?"v3":a;n&&i!==y&&console.warn("Stripe.js@".concat(i," was loaded on the page, but @stripe/stripe-js@").concat("8.7.0"," expected Stripe.js@").concat(y,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,t);return S(o,r),o},O=!1,I=function(){return t?t:t=(null!==k?k:(k=new Promise(function(e,t){if("u"<typeof window||"u"<typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var r,a=C();a?a&&null!==E&&null!==P&&(a.removeEventListener("load",E),a.removeEventListener("error",P),null==(r=a.parentNode)||r.removeChild(a),a=w(null)):a=w(null),E=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},P=function(e){t(Error("Failed to load Stripe.js",{cause:e}))},a.addEventListener("load",E),a.addEventListener("error",P)}catch(e){t(e);return}})).catch(function(e){return k=null,Promise.reject(e)})).catch(function(e){return t=null,Promise.reject(e)})};Promise.resolve().then(function(){return I()}).catch(function(e){O||console.warn(e)});var z=e.i(45009);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){D(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,a,s=e&&("u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=s){var n=[],i=!0,o=!1;try{for(s=s.call(e);!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var q=function(e,t,r){var s=!!r,n=a.default.useRef(r);a.default.useEffect(function(){n.current=r},[r]),a.default.useEffect(function(){if(!s||!e)return function(){};var r=function(){n.current&&n.current.apply(n,arguments)};return e.on(t,r),function(){e.off(t,r)}},[s,t,e,n])},L=function(e){var t=a.default.useRef(e);return a.default.useEffect(function(){t.current=e},[e]),t.current},H=function(e){return null!==e&&"object"===R(e)},B="[object Object]",U=function e(t,r){if(!H(t)||!H(r))return t===r;var a=Array.isArray(t);if(a!==Array.isArray(r))return!1;var s=Object.prototype.toString.call(t)===B;if(s!==(Object.prototype.toString.call(r)===B))return!1;if(!s&&!a)return t===r;var n=Object.keys(t),i=Object.keys(r);if(n.length!==i.length)return!1;for(var o={},l=0;l<n.length;l+=1)o[n[l]]=!0;for(var c=0;c<i.length;c+=1)o[i[c]]=!0;var d=Object.keys(o);return d.length===n.length&&d.every(function(a){return e(t[a],r[a])})},$=function(e,t,r){return H(e)?Object.keys(e).reduce(function(a,s){var n=!H(t)||!U(e[s],t[s]);return r.includes(s)?(n&&console.warn("Unsupported prop change: options.".concat(s," is not a mutable property.")),a):n?T(T({},a||{}),{},D({},s,e[s])):a},null):null},V="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V;if(null===e||H(e)&&"function"==typeof e.elements&&"function"==typeof e.createToken&&"function"==typeof e.createPaymentMethod&&"function"==typeof e.confirmCardPayment)return e;throw Error(t)},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V;if(H(e)&&"function"==typeof e.then)return{tag:"async",stripePromise:Promise.resolve(e).then(function(e){return W(e,t)})};var r=W(e,t);return null===r?{tag:"empty"}:{tag:"sync",stripe:r}},G=function(e){e&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"5.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},K=a.default.createContext(null);K.displayName="ElementsContext";var J=function(e,t){if(!e)throw Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},Q=function(e){var t=e.stripe,r=e.options,s=e.children,n=a.default.useMemo(function(){return Y(t)},[t]),i=_(a.default.useState(function(){return{stripe:"sync"===n.tag?n.stripe:null,elements:"sync"===n.tag?n.stripe.elements(r):null}}),2),o=i[0],l=i[1];a.default.useEffect(function(){var e=!0,t=function(e){l(function(t){return t.stripe?t:{stripe:e,elements:e.elements(r)}})};return"async"!==n.tag||o.stripe?"sync"!==n.tag||o.stripe||t(n.stripe):n.stripePromise.then(function(r){r&&e&&t(r)}),function(){e=!1}},[n,o,r]);var c=L(t);a.default.useEffect(function(){null!==c&&c!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[c,t]);var d=L(r);return a.default.useEffect(function(){if(o.elements){var e=$(r,d,["clientSecret","fonts"]);e&&o.elements.update(e)}},[r,d,o.elements]),a.default.useEffect(function(){G(o.stripe)},[o.stripe]),a.default.createElement(K.Provider,{value:o},s)};Q.propTypes={stripe:z.default.any,options:z.default.object};z.default.func.isRequired;var X=a.default.createContext(null);X.displayName="CheckoutContext",z.default.any,z.default.shape({clientSecret:z.default.oneOfType([z.default.string,z.default.instanceOf(Promise)]).isRequired,elementsOptions:z.default.object}).isRequired;var Z=function(e){var t=a.default.useContext(X),r=a.default.useContext(K);if(!t)return J(r,e);if(!r)return t;throw Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."))},ee=["mode"],et=function(e,t){var r="".concat(e.charAt(0).toUpperCase()+e.slice(1),"Element"),s=t?function(e){Z("mounts <".concat(r,">"));var t=e.id,s=e.className;return a.default.createElement("div",{id:t,className:s})}:function(t){var s,n=t.id,i=t.className,o=t.options,l=void 0===o?{}:o,c=t.onBlur,d=t.onFocus,m=t.onReady,u=t.onChange,p=t.onEscape,h=t.onClick,f=t.onLoadError,g=t.onLoaderStart,x=t.onNetworksChange,y=t.onConfirm,b=t.onCancel,v=t.onShippingAddressChange,j=t.onShippingRateChange,N=t.onSavedPaymentMethodRemove,C=t.onSavedPaymentMethodUpdate,w=Z("mounts <".concat(r,">")),S="elements"in w?w.elements:null,k="checkoutState"in w?w.checkoutState:null,P=(null==k?void 0:k.type)==="success"||(null==k?void 0:k.type)==="loading"?k.sdk:null,E=_(a.default.useState(null),2),A=E[0],O=E[1],I=a.default.useRef(null),z=a.default.useRef(null);q(A,"blur",c),q(A,"focus",d),q(A,"escape",p),q(A,"click",h),q(A,"loaderror",f),q(A,"loaderstart",g),q(A,"networkschange",x),q(A,"confirm",y),q(A,"cancel",b),q(A,"shippingaddresschange",v),q(A,"shippingratechange",j),q(A,"savedpaymentmethodremove",N),q(A,"savedpaymentmethodupdate",C),q(A,"change",u),m&&(s="expressCheckout"===e?m:function(){m(A)}),q(A,"ready",s),a.default.useLayoutEffect(function(){if(null===I.current&&null!==z.current&&(S||P)){var t=null;if(P)switch(e){case"paymentForm":t=P.createPaymentFormElement(l);break;case"payment":t=P.createPaymentElement(l);break;case"address":if("mode"in l){var a=l.mode,s=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r,a,s={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(l,ee);if("shipping"===a)t=P.createShippingAddressElement(s);else if("billing"===a)t=P.createBillingAddressElement(s);else throw Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":t=P.createExpressCheckoutElement(l);break;case"currencySelector":t=P.createCurrencySelectorElement();break;case"taxId":t=P.createTaxIdElement(l);break;default:throw Error("Invalid Element type ".concat(r,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else S&&(t=S.create(e,l));I.current=t,O(t),t&&t.mount(z.current)}},[S,P,l]);var F=L(l);return a.default.useEffect(function(){if(I.current){var e=$(l,F,["paymentRequest"]);e&&"update"in I.current&&I.current.update(e)}},[l,F]),a.default.useLayoutEffect(function(){return function(){if(I.current&&"function"==typeof I.current.destroy)try{I.current.destroy(),I.current=null}catch(e){}}},[]),a.default.createElement("div",{id:n,className:i,ref:z})};return s.propTypes={id:z.default.string,className:z.default.string,onChange:z.default.func,onBlur:z.default.func,onFocus:z.default.func,onReady:z.default.func,onEscape:z.default.func,onClick:z.default.func,onLoadError:z.default.func,onLoaderStart:z.default.func,onNetworksChange:z.default.func,onConfirm:z.default.func,onCancel:z.default.func,onShippingAddressChange:z.default.func,onShippingRateChange:z.default.func,onSavedPaymentMethodRemove:z.default.func,onSavedPaymentMethodUpdate:z.default.func,options:z.default.object},s.displayName=r,s.__elementType=e,s},er="u"<typeof window;a.default.createContext(null).displayName="EmbeddedCheckoutProviderContext",et("auBankAccount",er),et("card",er),et("cardNumber",er),et("cardExpiry",er),et("cardCvc",er),et("iban",er);var ea=et("payment",er);et("expressCheckout",er),et("paymentRequestButton",er),et("linkAuthentication",er),et("address",er),et("shippingAddress",er),et("paymentMethodMessaging",er),et("taxId",er);var es=e.i(5539),en=e.i(75157),ei=e.i(59544);let eo=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];O=!0;var a=Date.now();return I().then(function(e){return A(e,t,a)})}("pk_test_LIvd1lIqY5NOcrlzRRdCtTOj00iQtxXAoa");function el({checkoutData:e,clientSecret:t,orderId:s,onSuccess:i,onError:o}){var l;let c=Z("calls useStripe()").stripe,m=(l="calls useElements()",J(a.default.useContext(K),l)).elements,[u,p]=(0,a.useState)(!1),{cart:h}=(0,es.useCart)(),f=async()=>{if(!c||!m)return void o("Stripe non ancora caricato. Riprova tra un momento.");p(!0);try{let{error:e}=await c.confirmPayment({elements:m,redirect:"if_required",confirmParams:{return_url:`${window.location.origin}/ordine/conferma`}});if(e)o(e.message||"Errore durante il pagamento");else{let e=t.split("_secret_")[0],r=await fetch("/api/checkout/confirm-order.php",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({paymentIntentId:e,orderId:s})}),a=await r.json();a.success||console.warn("Confirm order failed, webhook will handle:",a.error),i()}}catch(e){o("Errore di rete. Riprova tra un momento.")}finally{p(!1)}};return(0,r.jsx)(n.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg border-2 border-brand-rose p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,r.jsx)(d.CreditCard,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Inserisci i dati di pagamento"]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(ea,{})}),(0,r.jsx)(ei.default,{onClick:f,disabled:!c||u,isLoading:u,className:"w-full",size:"lg",children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Elaborazione pagamento..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.CreditCard,{className:"h-4 w-4 mr-2"}),"Paga ",(0,en.formatPrice)(h.total)]})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-3 text-center",children:"I tuoi dati sono protetti con crittografia SSL a 256 bit"})]})})}function ec(){let e=(0,s.useRouter)(),{cart:t,isLoaded:x,clearCart:y}=(0,es.useCart)(),[b,v]=(0,a.useState)({customer:{email:"",firstName:"",lastName:"",phone:""},shippingAddress:{address:"",city:"",province:"",postalCode:"",country:"Italia"},sameAsBilling:!0,requiresInvoice:!1,paymentMethod:"card"}),[j,N]=(0,a.useState)({}),[C,w]=(0,a.useState)(!1),[S,k]=(0,a.useState)(""),[P,E]=(0,a.useState)(0),[A,O]=(0,a.useState)(!1),[I,z]=(0,a.useState)("");(0,a.useEffect)(()=>{x&&0===t.items.length&&!A&&e.push("/carrello")},[x,t.items.length,e,A]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me",{credentials:"include"});if(e.ok){let t=await e.json();t.success&&t.user&&v(e=>({...e,customer:{email:t.user.email||"",firstName:t.user.firstName||"",lastName:t.user.lastName||"",phone:t.user.phone||""}}))}}catch(e){console.log("User not logged in")}})()},[]);let F=(e,t)=>{v(r=>{let a=e.split(".");if(1===a.length)return{...r,[e]:t};if(2===a.length){let e=r[a[0]];return{...r,[a[0]]:{..."object"==typeof e&&null!==e?e:{},[a[1]]:t}}}if(3===a.length){let e=r[a[0]];return{...r,[a[0]]:{..."object"==typeof e&&null!==e?e:{},[a[1]]:{..."object"==typeof e?.[a[1]]&&e?.[a[1]]!==null?e[a[1]]:{},[a[2]]:t}}}}return r}),j[e]&&N(t=>({...t,[e]:""}))},T=async()=>{let e;if(z(""),e={},b.customer.email||(e.email="Email richiesta"),b.customer.firstName||(e.firstName="Nome richiesto"),b.customer.lastName||(e.lastName="Cognome richiesto"),b.customer.phone||(e.phone="Telefono richiesto"),b.customer.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b.customer.email)&&(e.email="Email non valida"),b.shippingAddress.address||(e.address="Indirizzo richiesto"),b.shippingAddress.city||(e.city="CittÃ  richiesta"),b.shippingAddress.province||(e.province="Provincia richiesta"),b.shippingAddress.postalCode||(e.postalCode="CAP richiesto"),b.requiresInvoice&&b.invoiceData&&(b.invoiceData.codiceFiscale||(e.codiceFiscale="Codice fiscale richiesto"),"azienda"===b.invoiceData.customerType&&(b.invoiceData.ragioneSociale||(e.ragioneSociale="Ragione sociale richiesta"),b.invoiceData.partitaIva||(e.partitaIva="Partita IVA richiesta"))),!b.sameAsBilling&&b.billingAddress&&(b.billingAddress.address||(e.billingAddress="Indirizzo fatturazione richiesto"),b.billingAddress.city||(e.billingCity="CittÃ  fatturazione richiesta"),b.billingAddress.province||(e.billingProvince="Provincia fatturazione richiesta"),b.billingAddress.postalCode||(e.billingPostalCode="CAP fatturazione richiesto")),N(e),0!==Object.keys(e).length)return void z("Compila tutti i campi richiesti");w(!0);try{let e=t.items.map(e=>({productCode:e.product.code,name:e.product.name,quantity:e.quantity,unitPrice:e.variant?.price||e.product.price,variantSku:e.variant?.sku||null,variantName:e.variant?.name||e.variant?.size||null,isVirtualVariant:e.variant?.is_virtual||!1,orderedSize:e.variant?.size||null})),r=await fetch("/api/checkout/create-payment-intent.php",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({items:e,customer:{email:b.customer.email,name:`${b.customer.firstName} ${b.customer.lastName}`.trim(),phone:b.customer.phone},shippingAddress:b.shippingAddress,billingAddress:b.sameAsBilling?null:b.billingAddress,requiresInvoice:b.requiresInvoice,invoiceData:b.requiresInvoice?b.invoiceData:null,notes:b.notes||"",paymentMethod:b.paymentMethod})}),a=await r.json();a.success?(k(a.clientSecret),E(a.orderId),O(!0)):z(a.error||"Errore nella creazione del pagamento")}catch(e){z("Errore di rete. Riprova tra un momento.")}finally{w(!1)}};return 0===t.items.length?null:x?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)(n.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Checkout"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Completa il tuo ordine"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)(i.AnimatePresence,{mode:"wait",children:A?(0,r.jsx)(n.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,r.jsx)(Q,{stripe:eo,options:{clientSecret:S,appearance:{theme:"stripe",variables:{colorPrimary:"#8b1538"}},locale:"it"},children:(0,r.jsx)(el,{checkoutData:b,clientSecret:S,orderId:P,onSuccess:()=>{y();let t=S.split("_secret_")[0];e.push(`/ordine/conferma?payment_intent=${t}&order_id=${P}&redirect_status=succeeded`)},onError:e=>{z(e),O(!1),k("")}})})},"payment"):(0,r.jsxs)(n.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-8",children:[I&&(0,r.jsxs)(n.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center",children:[(0,r.jsx)(f.AlertCircle,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-red-700",children:I})]}),(0,r.jsxs)(n.motion.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,r.jsx)(o.User,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Dati Personali"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,r.jsx)("input",{id:"email",type:"email",required:!0,value:b.customer.email,onChange:e=>F("customer.email",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.email?"border-red-300":"border-gray-300"),placeholder:"mario.rossi@email.com"}),j.email&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),(0,r.jsx)("input",{id:"firstName",type:"text",required:!0,value:b.customer.firstName,onChange:e=>F("customer.firstName",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.firstName?"border-red-300":"border-gray-300"),placeholder:"Mario"}),j.firstName&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cognome *"}),(0,r.jsx)("input",{id:"lastName",type:"text",required:!0,value:b.customer.lastName,onChange:e=>F("customer.lastName",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.lastName?"border-red-300":"border-gray-300"),placeholder:"Rossi"}),j.lastName&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.lastName})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefono *"}),(0,r.jsx)("input",{id:"phone",type:"tel",required:!0,value:b.customer.phone,onChange:e=>F("customer.phone",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.phone?"border-red-300":"border-gray-300"),placeholder:"+39 123 456 7890"}),j.phone&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.phone})]})]})]}),(0,r.jsxs)(n.motion.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,r.jsx)(l.MapPin,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Indirizzo di Spedizione"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Indirizzo *"}),(0,r.jsx)("input",{id:"address",type:"text",required:!0,value:b.shippingAddress.address,onChange:e=>F("shippingAddress.address",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.address?"border-red-300":"border-gray-300"),placeholder:"Via Roma, 123"}),j.address&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.address})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"CittÃ  *"}),(0,r.jsx)("input",{id:"city",type:"text",required:!0,value:b.shippingAddress.city,onChange:e=>F("shippingAddress.city",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.city?"border-red-300":"border-gray-300"),placeholder:"Milano"}),j.city&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.city})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700 mb-1",children:"Provincia *"}),(0,r.jsx)("input",{id:"province",type:"text",required:!0,value:b.shippingAddress.province,onChange:e=>F("shippingAddress.province",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.province?"border-red-300":"border-gray-300"),placeholder:"MI"}),j.province&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.province})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"CAP *"}),(0,r.jsx)("input",{id:"postalCode",type:"text",required:!0,value:b.shippingAddress.postalCode,onChange:e=>F("shippingAddress.postalCode",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.postalCode?"border-red-300":"border-gray-300"),placeholder:"20100"}),j.postalCode&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.postalCode})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nazione"}),(0,r.jsx)("input",{id:"country",type:"text",value:b.shippingAddress.country,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]})]})]}),(0,r.jsxs)(n.motion.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,r.jsx)(p,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Fatturazione"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:b.requiresInvoice,onChange:e=>{F("requiresInvoice",e.target.checked),e.target.checked?F("invoiceData",{customerType:"privato",codiceFiscale:""}):F("invoiceData",void 0)},className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300 rounded"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Richiedi fattura"})]}),(0,r.jsx)(i.AnimatePresence,{children:b.requiresInvoice&&(0,r.jsxs)(n.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo cliente"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"customerType",value:"privato",checked:b.invoiceData?.customerType==="privato",onChange:e=>F("invoiceData.customerType",e.target.value),className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Privato"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",name:"customerType",value:"azienda",checked:b.invoiceData?.customerType==="azienda",onChange:e=>F("invoiceData.customerType",e.target.value),className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Azienda"})]})]})]}),b.invoiceData?.customerType==="azienda"&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"ragioneSociale",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ragione Sociale *"}),(0,r.jsx)("input",{id:"ragioneSociale",type:"text",value:b.invoiceData?.ragioneSociale||"",onChange:e=>F("invoiceData.ragioneSociale",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.ragioneSociale?"border-red-300":"border-gray-300"),placeholder:"Azienda S.r.l."}),j.ragioneSociale&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.ragioneSociale})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"partitaIva",className:"block text-sm font-medium text-gray-700 mb-1",children:"Partita IVA *"}),(0,r.jsx)("input",{id:"partitaIva",type:"text",value:b.invoiceData?.partitaIva||"",onChange:e=>F("invoiceData.partitaIva",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.partitaIva?"border-red-300":"border-gray-300"),placeholder:"12345678901"}),j.partitaIva&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.partitaIva})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"codiceFiscale",className:"block text-sm font-medium text-gray-700 mb-1",children:"Codice Fiscale *"}),(0,r.jsx)("input",{id:"codiceFiscale",type:"text",value:b.invoiceData?.codiceFiscale||"",onChange:e=>F("invoiceData.codiceFiscale",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.codiceFiscale?"border-red-300":"border-gray-300"),placeholder:"RSSMRA80A01H501U"}),j.codiceFiscale&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.codiceFiscale})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"codiceSdi",className:"block text-sm font-medium text-gray-700 mb-1",children:["Codice SDI ",(0,r.jsx)("span",{className:"text-gray-400",children:"(opzionale)"})]}),(0,r.jsx)("input",{id:"codiceSdi",type:"text",value:b.invoiceData?.codiceSdi||"",onChange:e=>F("invoiceData.codiceSdi",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",placeholder:"ABCDEFG"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"pec",className:"block text-sm font-medium text-gray-700 mb-1",children:["PEC ",(0,r.jsx)("span",{className:"text-gray-400",children:"(opzionale)"})]}),(0,r.jsx)("input",{id:"pec",type:"email",value:b.invoiceData?.pec||"",onChange:e=>F("invoiceData.pec",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",placeholder:"azienda@pec.it"})]})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:!b.sameAsBilling,onChange:e=>{F("sameAsBilling",!e.target.checked),e.target.checked?F("billingAddress",{address:"",city:"",province:"",postalCode:"",country:"Italia"}):F("billingAddress",void 0)},className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300 rounded"}),(0,r.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700",children:"Indirizzo di fatturazione diverso da quello di spedizione"})]}),!b.sameAsBilling&&(0,r.jsxs)(n.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"billingAddress",className:"block text-sm font-medium text-gray-700 mb-1",children:"Indirizzo Fatturazione *"}),(0,r.jsx)("input",{id:"billingAddress",type:"text",value:b.billingAddress?.address||"",onChange:e=>F("billingAddress.address",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.billingAddress?"border-red-300":"border-gray-300"),placeholder:"Via della Fatturazione, 456"}),j.billingAddress&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.billingAddress})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"billingCity",className:"block text-sm font-medium text-gray-700 mb-1",children:"CittÃ  *"}),(0,r.jsx)("input",{id:"billingCity",type:"text",value:b.billingAddress?.city||"",onChange:e=>F("billingAddress.city",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.billingCity?"border-red-300":"border-gray-300"),placeholder:"Roma"}),j.billingCity&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.billingCity})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"billingProvince",className:"block text-sm font-medium text-gray-700 mb-1",children:"Provincia *"}),(0,r.jsx)("input",{id:"billingProvince",type:"text",value:b.billingAddress?.province||"",onChange:e=>F("billingAddress.province",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.billingProvince?"border-red-300":"border-gray-300"),placeholder:"RM"}),j.billingProvince&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.billingProvince})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"billingPostalCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"CAP *"}),(0,r.jsx)("input",{id:"billingPostalCode",type:"text",value:b.billingAddress?.postalCode||"",onChange:e=>F("billingAddress.postalCode",e.target.value),className:(0,en.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors",j.billingPostalCode?"border-red-300":"border-gray-300"),placeholder:"00100"}),j.billingPostalCode&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.billingPostalCode})]})]})]})})]})]}),(0,r.jsxs)(n.motion.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,r.jsx)(c.FileText,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Note Ordine"]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:["Note aggiuntive ",(0,r.jsx)("span",{className:"text-gray-400",children:"(opzionale)"})]}),(0,r.jsx)("textarea",{id:"notes",rows:3,value:b.notes||"",onChange:e=>F("notes",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-rose focus:border-brand-rose transition-colors resize-none",placeholder:"Istruzioni speciali per la consegna..."})]})]}),(0,r.jsxs)(n.motion.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,r.jsx)(d.CreditCard,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Metodo di Pagamento"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)(n.motion.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:(0,en.cn)("border-2 rounded-lg p-4 cursor-pointer transition-all","card"===b.paymentMethod?"border-brand-rose bg-brand-pink-light":"border-gray-200 hover:border-gray-300"),onClick:()=>F("paymentMethod","card"),children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("input",{type:"radio",name:"paymentMethod",value:"card",checked:"card"===b.paymentMethod,onChange:()=>F("paymentMethod","card"),className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 font-medium",children:"ðŸ’³ Carta"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Visa, Mastercard, American Express"})]}),(0,r.jsxs)(n.motion.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:(0,en.cn)("border-2 rounded-lg p-4 cursor-pointer transition-all","klarna"===b.paymentMethod?"border-brand-rose bg-brand-pink-light":"border-gray-200 hover:border-gray-300"),onClick:()=>F("paymentMethod","klarna"),children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("input",{type:"radio",name:"paymentMethod",value:"klarna",checked:"klarna"===b.paymentMethod,onChange:()=>F("paymentMethod","klarna"),className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 font-medium",children:"ðŸ©· Klarna"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Paga in 3 rate senza interessi"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4 opacity-50",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("input",{type:"radio",name:"paymentMethod",value:"paypal",disabled:!0,className:"h-4 w-4 text-brand-rose focus:ring-brand-rose border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 font-medium",children:"ðŸŸ¡ PayPal"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Paga con il tuo account PayPal"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 rounded-lg",children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Presto disponibile"})})]})]})]}),(0,r.jsxs)(n.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsx)(ei.default,{onClick:T,isLoading:C,disabled:C,className:"w-full",size:"lg",children:C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Preparazione pagamento..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.CreditCard,{className:"h-4 w-4 mr-2"}),"Procedi al pagamento Â· ",(0,en.formatPrice)(t.total)]})}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-3 text-center",children:['Cliccando "Procedi al pagamento" accetti i nostri'," ",(0,r.jsx)("a",{href:"/termini",className:"text-brand-rose hover:underline",children:"Termini e Condizioni"})," ","e la"," ",(0,r.jsx)("a",{href:"/privacy",className:"text-brand-rose hover:underline",children:"Privacy Policy"})]})]})]},"form")})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsx)(n.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"sticky top-8",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,r.jsx)(m.ShoppingBag,{className:"h-5 w-5 mr-2 text-brand-rose"}),"Riepilogo Ordine"]}),(0,r.jsx)("div",{className:"space-y-3 mb-6",children:t.items.map((e,t)=>(0,r.jsxs)(n.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:e.product.images[0]?.url||"/placeholder.jpg",alt:e.product.name,className:"w-12 h-12 object-cover rounded-lg"}),(0,r.jsx)("span",{className:"absolute -top-2 -right-2 bg-brand-rose text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:e.quantity})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.product.name}),e.variant&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.variant.name||e.variant.size})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,en.formatPrice)((e.variant?.price||e.product.price)*e.quantity)})]},`${e.product.code}-${e.variant?.sku||"default"}`))}),(0,r.jsx)("hr",{className:"border-gray-200 mb-4"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Subtotale"}),(0,r.jsx)("span",{className:"text-gray-900",children:(0,en.formatPrice)(t.subtotal)})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600 flex items-center",children:[(0,r.jsx)(u.Truck,{className:"h-4 w-4 mr-1"}),"Spedizione"]}),(0,r.jsx)("span",{className:(0,en.cn)(0===t.shipping?"text-green-600 font-medium":"text-gray-900"),children:0===t.shipping?"Gratuita":(0,en.formatPrice)(t.shipping)})]}),0===t.shipping&&t.subtotal<es.FREE_SHIPPING_THRESHOLD&&(0,r.jsxs)("div",{className:"text-xs text-green-600 bg-green-50 p-2 rounded",children:[(0,r.jsx)(h.CheckCircle,{className:"h-3 w-3 inline mr-1"}),"Spedizione gratuita applicata!"]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"IVA inclusa"}),(0,r.jsx)("span",{className:"text-gray-900",children:(0,en.formatPrice)(t.tax)})]}),(0,r.jsx)("hr",{className:"border-gray-200"}),(0,r.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,r.jsx)("span",{className:"text-gray-900",children:"Totale"}),(0,r.jsx)("span",{className:"text-brand-rose",children:(0,en.formatPrice)(t.total)})]})]}),t.subtotal<es.FREE_SHIPPING_THRESHOLD&&(0,r.jsxs)(n.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-brand-pink-light rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,r.jsx)("span",{className:"text-brand-rose-dark font-medium",children:"Spedizione gratuita"}),(0,r.jsxs)("span",{className:"text-brand-rose-dark",children:[(0,en.formatPrice)(es.FREE_SHIPPING_THRESHOLD-t.subtotal)," rimanenti"]})]}),(0,r.jsx)("div",{className:"w-full bg-white rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-brand-rose h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(t.subtotal/es.FREE_SHIPPING_THRESHOLD*100,100)}%`}})})]})]})})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(g.Loader2,{className:"w-8 h-8 text-brand-rose animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Caricamento..."})]})})}e.s(["default",()=>ec],69439)}]);